# CodeSearch cable channel for Television ≥ 0.15
#
# Television 0.15 changed cable channels from a single cable.toml file with
# [[cable_channel]] sections to individual .toml files per channel placed in
# ~/.config/television/cable/.  It also removed dynamic {query} re-execution —
# source commands now run once and Television does its own fuzzy matching over
# the results.
#
# Consequence for semantic search: live per-keystroke semantic search is no
# longer possible via a cable channel.  Use the Zed task
# "codesearch: search" (ctrl-shift-f) instead — it prompts for a query, runs
# codesearch, and pipes the results through Television as a result picker.
#
# This channel lists indexed repository paths so that `tv codesearch` remains
# functional (showing repos for quick navigation rather than semantic search).
#
# Installation (handled automatically by ide/zed/setup.sh):
#   cp ide/tv/cable/codesearch.toml ~/.config/television/cable/

[metadata]
name = "codesearch"
description = "Browse CodeSearch indexed repositories (semantic search → Zed ctrl-shift-f)"
requirements = ["codesearch"]

[source]
# Extracts one repository path per line from `codesearch list` output.
command = "codesearch list 2>/dev/null | sed -n 's/^[[:space:]]*Path:[[:space:]]//p'"
no_sort = true
frecency = false

[preview]
command = "ls -la {}"

[actions.open]
description = "Open repository in Zed"
command = "zed {}"
mode = "fork"
